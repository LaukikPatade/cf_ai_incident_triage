name = "ai-incident-triage"
main = "src/worker.ts"
compatibility_date = "2024-01-01"

# Durable Objects binding
[[durable_objects.bindings]]
name = "INCIDENT"
class_name = "IncidentDurableObject"

# Migrations for Durable Objects (using SQLite for free tier)
[[migrations]]
tag = "v1"
new_sqlite_classes = ["IncidentDurableObject"]

# Workers AI binding
[ai]
binding = "AI"

# KV Namespaces
[[kv_namespaces]]
binding = "INCIDENT_HISTORY"
id = "2821e8b3aa9349ceae0a57389bda0c94"

[[kv_namespaces]]
binding = "TEMPLATES"
id = "cfcc6b8bce2c4f7e9695157fe52038c6"

# Vectorize for semantic search
[[vectorize]]
binding = "VECTORIZE"
index_name = "incident-embeddings"

# R2 for report storage
[[r2_buckets]]
binding = "INCIDENT_REPORTS"
bucket_name = "incident-reports"

# CORS configuration
[vars]
ALLOWED_ORIGINS = "http://localhost:5173,https://cf-ai-incident-triage.pages.dev,https://3c3bcdb9.cf-ai-incident-triage.pages.dev"
